import re
with open("04.txt") as fp:
    print(len([vp for vp in [{k: v for k, v in [e.split(":") for e in p.strip().split(" ")]} for p in fp.read().replace("\n\n", ",").replace("\n", " ").split(",")] if all(mk in vp.keys() for mk in ["byr", "iyr", "eyr", "hgt", "hcl", "ecl", "pid"]) and int(vp["byr"]) >= 1920 and int(vp["byr"]) <= 2002 and int(vp["iyr"]) >= 2010 and int(vp["iyr"]) <= 2020 and int(vp["eyr"]) >= 2020 and int(vp["eyr"]) <= 2030 and ((vp["hgt"][-2:] == "in" and int(vp["hgt"][:-2]) >= 59 and int(vp["hgt"][:-2]) <= 76) or (vp["hgt"][-2:] == "cm" and int(vp["hgt"][:-2]) >= 150 and int(vp["hgt"][:-2]) <= 193)) and re.match(r"^#([0-9a-f]){6}$", vp["hcl"]) and vp["ecl"] in ["amb", "blu", "brn", "gry", "grn", "hzl", "oth"] and re.match(r"^([0-9]){9}$", vp["pid"])]))
